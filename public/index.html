<!DOCTYPE html>
<html>
<head>
    <title>AI Video Generator</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 50px; }
        #loader { display: none; margin-top: 20px; color: blue; }
        .history-item { border-bottom: 1px solid #ccc; padding: 10px; }
    </style>
</head>
<body>
    <h1>AI Video Prompt</h1>
    <input id="user" type="text" placeholder="Your Name"><br><br>
    <textarea id="prompt" placeholder="Describe the video you want..."></textarea><br><br>
    <button onclick="generate()">Generate Video</button>

    <div id="loader">ðŸŽ¥ AI is rendering your video... please wait.</div>
    <div id="history"></div>

    <script>
        async function generate() {
            const user = document.getElementById('user').value || "Guest";
            const prompt = document.getElementById('prompt').value;
            const loader = document.getElementById('loader');

            loader.style.display = 'block';

            await fetch('/api/generate', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ user, prompt })
            });

            setTimeout(() => {
                loader.style.display = 'none';
                alert("Task submitted! Check back in 1 minute.");
                loadHistory();
            }, 2000);
        }

        async function loadHistory() {
            const res = await fetch('/api/history');
            const data = await res.json();
            const div = document.getElementById('history');
            div.innerHTML = "<h3>Recent Prompts</h3>" + data.map(h => 
                `<div class="history-item"><b>${h.user}:</b> ${h.prompt} (${h.status})</div>`
            ).join('');
        }
        loadHistory();
    </script>
</body>
</html>
